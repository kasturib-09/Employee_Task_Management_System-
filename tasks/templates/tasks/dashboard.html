{% extends 'tasks/base.html' %}

{% block content %}

<h3>Dashboard</h3>

<div class="row text-center mb-3">
    <div class="col-md-4"><div class="card bg-primary text-white p-3">Total: {{ total }}</div></div>
    <div class="col-md-4"><div class="card bg-success text-white p-3">Completed: {{ completed }}</div></div>
    <div class="col-md-4"><div class="card bg-warning text-white p-3">Pending: {{ pending }}</div></div>
</div>

{% if request.user.is_superuser %}
<a href="{% url 'add_task' %}" class="btn btn-success">Add Task</a>
<a href="{% url 'add_employee' %}" class="btn btn-primary">Add Employee</a>
{% endif %}

<form method="get" class="row mt-3 mb-3">
    <div class="col-md-3">
        <input type="text" name="search" placeholder="Search..." class="form-control">
    </div>

    <div class="col-md-3">
        <select name="priority" class="form-control">
            <option value="">Priority</option>
            <option>High</option>
            <option>Medium</option>
            <option>Low</option>
        </select>
    </div>

    <div class="col-md-3">
        <select name="status" class="form-control">
            <option value="">Status</option>
            <option>Pending</option>
            <option>Completed</option>
        </select>
    </div>

    <div class="col-md-3">
        <button class="btn btn-dark">Filter</button>
    </div>
</form>

<table class="table table-bordered">
<tr>
    <th>Title</th>
    <th>Priority</th>
    <th>Status</th>
    <th>Assigned</th>
    <th>Actions</th>
</tr>

{% for task in tasks %}
<tr>
    <td>{{ task.title }}</td>
    <td>{{ task.priority }}</td>
    <td>
        {% if task.status == 'Completed' %}
            <span class="badge bg-success">Completed</span>
        {% else %}
            <span class="badge bg-warning">Pending</span>
        {% endif %}
    </td>
    <td>{{ task.assigned_to }}</td>
    <td>
        {% if request.user.is_superuser %}
        <a href="{% url 'edit_task' task.id %}" class="btn btn-warning btn-sm">Edit</a>
        <a href="{% url 'delete_task' task.id %}" class="btn btn-danger btn-sm">Delete</a>
        {% endif %}
    </td>
</tr>
{% endfor %}
</table>

{% endblock %}